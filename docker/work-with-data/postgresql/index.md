---
metaTitle: Работа с PostgreSQL в Docker
metaDescription: Узнайте как развернуть и управлять PostgreSQL в Docker от установки до конфигурации различных параметров с примерами кода
author: Олег Марков
title: Работа с PostgreSQL в Docker
preview: В этом руководстве мы рассмотрим как установить PostgreSQL в Docker определить основные команды и настроить контейнер для эффективной работы с базами данных
---

## Введение

Давайте погрузимся в мир контейнеризации баз данных и узнаем, как PostgreSQL может работать в Docker. Это современный подход, который позволяет нам не только быстро развернуть базу данных, но и сделать её удобной в управлении и переносе. Мы изучим основы установки, конфигурации и мониторинга PostgreSQL в Docker. Это станет полезным навыком для разработчиков, ищущих простоту и гибкость при работе с базами данных.

## Установка и настройка

Давайте начнем с того, как можно установить PostgreSQL с помощью Docker. Предполагается, что Docker у вас уже установлен и запущен. Если нет, убедитесь, что вы установили его с официального сайта Docker.

Развертывание PostgreSQL в Docker это важный шаг, но управление контейнерами и их конфигурацией может стать сложной задачей. Для упрощения этих процессов и автоматизации задач развертывания и управления, рекомендуем изучить Ansible. В рамках [Docker + Ansible - с нуля](https://purpleschool.ru/course/docker?utm_source=knowledgebase&utm_medium=text&utm_campaign=Rabota_s_MySQL_v_Docker) мы расскажем, как использовать Ansible для автоматической настройки PostgreSQL контейнеров и управления ими. На курсе 159 уроков и 7 упражнений, AI-тренажеры для безлимитной практики с кодом и задачами 24/7, решение задач с живым ревью наставника, еженедельные встречи с менторами.

### Загрузка официального образа

Первое, что нам нужно сделать, это загрузить официальный образ PostgreSQL из Docker Hub. Это делается с помощью следующей команды:

```bash
docker pull postgres
```

Эта команда загружает последний образ PostgreSQL. Вы можете заметить, что это быстро и удобно, так как вы избавляетесь от необходимости делать сложную установку традиционным способом. Docker делает это за вас!

### Запуск контейнера

Теперь, когда у нас есть образ, мы можем запустить контейнер с PostgreSQL. Давайте посмотрим, как это делается:

```bash
docker run --name my_postgres -e POSTGRES_PASSWORD=mysecretpassword -d postgres
```

В этой команде:

- `--name my_postgres` задает имя контейнера, чтобы легче было его идентифицировать.
- `-e POSTGRES_PASSWORD=mysecretpassword` устанавливает пароль для пользователя "postgres".
- `-d postgres` делает так, чтобы контейнер запускался в фоновом режиме.

Обратите внимание, пароль лучше задавать более надежный. После запуска вы можете проверить список запущенных контейнеров с помощью команды:

```bash
docker ps
```

### Подключение к базе данных

Теперь, когда контейнер запущен, вы можете подключиться к базе данных. Для этого используется команда `docker exec`, которая позволяет выполнять команды внутри самого контейнера:

```bash
docker exec -it my_postgres psql -U postgres
```

Здесь `-it` дает нам возможность взаимодействовать с контейнером, а `psql -U postgres` запускает клиент PostgreSQL и подключается к базе данных под пользователем "postgres".

## Управление данными

Теперь давайте разберемся, как работать с нашими данными в контейнере.

### Создание базы данных

Смотрите, я покажу вам, как легко создать новую базу данных:

```sql
CREATE DATABASE mydatabase;
```

Эту команду можно выполнить сразу после подключения к клиенту `psql`. PostgreSQL позволит вам создавать базы данных и таблицы, как в любом другом окружении.

### Импорт и экспорт данных

Поддержка импорта и экспорта данных помогает управлять базой данных. Например, вы можете экспортировать данные следующей командой:

```bash
docker exec my_postgres pg_dump -U postgres mydatabase > mydatabase.sql
```

Здесь данные из базы `mydatabase` сохраняются в файл `mydatabase.sql`. Аналогично, импорт данных можно реализовать так:

```bash
docker exec -i my_postgres psql -U postgres -d mydatabase < mydatabase.sql
```

Этот подход ускоряет миграцию данных и упрощает их копирование между различными окружениями.

## Настройка контейнера

### Объемы данных и резервное копирование

По умолчанию данные сохраняются внутри контейнера, но это не является надежным способом хранения в производственной среде. Давайте создадим постоянные объемы данных (volumes) для сохранения информации:

```bash
docker run --name my_postgres -v my_dbdata:/var/lib/postgresql/data -e POSTGRES_PASSWORD=mysecretpassword -d postgres
```

С помощью параметра `-v my_dbdata:/var/lib/postgresql/data` мы указываем, что данные из контейнера должны сохраняться в указанном месте. Это значит, что когда контейнер будет удален или пересоздан, данные останутся на месте.

## Обновление PostgreSQL

Для обновления PostgreSQL в Docker мы можем просто скачать обновленный образ и перезапустить контейнер:

```bash
docker pull postgres
docker stop my_postgres
docker rm my_postgres
docker run --name my_postgres -v my_dbdata:/var/lib/postgresql/data -e POSTGRES_PASSWORD=mysecretpassword -d postgres
```

Это позволит получить последние обновления без сложных манипуляций.

## Заключение

Поздравляю, теперь вы освоили основные моменты работы с PostgreSQL в Docker. Мы рассмотрели, как установить, настроить и управлять этой мощной базой данных в контейнере. Контейнеризация с Docker упрощает процесс развертывания и миграции, делая работу с базами данных более гибкой и эффективной. Теперь у вас есть все инструменты для начала использования PostgreSQL в Docker в ваших проектах.

Управление PostgreSQL в Docker требует понимания не только базовых настроек, но и принципов автоматизации и оркестрации. Чтобы не заниматься ручной настройкой каждого контейнера, используйте Ansible. На курсе [Docker + Ansible - с нуля](https://purpleschool.ru/course/docker?utm_source=knowledgebase&utm_medium=text&utm_campaign=Rabota_s_MySQL_v_Docker) вы научитесь создавать плейбуки для автоматической настройки PostgreSQL контейнеров, их развертывания и управления. В первых 3 модулях уже доступно бесплатное содержание — начните погружаться в мир Docker и Ansible прямо сегодня.
