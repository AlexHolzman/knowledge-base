---
metaTitle: Работа с GitLab в Docker
metaDescription: Узнайте, как развернуть GitLab в Docker - от установки Docker до настройки GitLab CI-CD. Подробные шаги и примеры помогут вам легко освоить процесс
author: Олег Марков
title: Работа с GitLab в Docker
preview: Узнайте, как развернуть и настроить GitLab в Docker. Подробные инструкции, чтобы вы могли быстро начать использовать все возможности GitLab
---

## Введение

Приветствую вас в этой статье, где мы погрузимся в мир работы с GitLab в Docker. Если вы когда-нибудь задумывались, как можно быстро и эффективно развернуть GitLab на вашем сервере, этой статье будет полезной для вас. Docker предлагает удобный и простой способ установки и управления приложениями, и GitLab не исключение. В этой статье я покажу вам шаг за шагом, как это сделать. Давайте начнем!

## Установка Docker

### Подготовка системы

Для начала вам понадобится установить Docker на вашу машину. Давайте разберемся, как это сделать. Убедитесь, что у вас права администратора и ваш сервер настроен на работу с Docker.

### Установка Docker

Первым шагом будет установка Docker. Это можно сделать, следуя инструкции на официальном сайте Docker, но для удобства я собираюсь показать вам основные команды, которые необходимы:

```bash
sudo apt-get update
sudo apt-get install docker-ce docker-ce-cli containerd.io
```

Как видите, здесь мы обновляем пакеты и устанавливаем Docker CE, его CLI и containerd.

## Запуск GitLab в Docker

### Подготовка к установке GitLab

Перед тем как установить GitLab в контейнере, нам нужно убедиться, что Docker установлен и работает. Проверим это с помощью команды:

```bash
docker --version
```

Если вы видите номер версии, значит все готово. Теперь перейдем к следующему шагу.

### Создание контейнера GitLab

Теперь, когда Docker установлен, мы можем создать контейнер для GitLab. Вот как это сделать:

```bash
docker run --detach \
  --hostname gitlab.example.com \
  --publish 443:443 --publish 80:80 --publish 22:22 \
  --name gitlab \
  --restart always \
  --volume /srv/gitlab/config:/etc/gitlab \
  --volume /srv/gitlab/logs:/var/log/gitlab \
  --volume /srv/gitlab/data:/var/opt/gitlab \
  gitlab/gitlab-ce:latest
```

Здесь:

- `--detach` запускает контейнер в фоновом режиме.
- `--hostname` устанавливает имя хоста для GitLab.
- `--publish` связывает порты контейнера с портами вашего сервера.
- `--name` задает имя контейнера.
- `--restart always` перезапускает контейнер в случае сбоя.
- `--volume` определяет, какие директории на вашем сервере будут использоваться для хранения конфигураций, логов и данных GitLab.

### Проверка установки

Чтобы убедиться, что все работает правильно, откройте браузер и перейдите по адресу `http://gitlab.example.com`. Вас встретит интерфейс GitLab, и вы сможете настроить ваш аккаунт.

## Настройка GitLab CI/CD

### Добавление .gitlab-ci.yml

После развертывания GitLab мы можем настроить процессы CI/CD. Вам понадобится файл конфигурации `.gitlab-ci.yml`. Давайте посмотрим, как может выглядеть простой пример этого файла:

```yaml
stages:
  - build
  - test

build_job:
  stage: build
  script:
    - echo "Building the project"
    - make build

test_job:
  stage: test
  script:
    - echo "Running tests"
    - make test
```

Здесь мы определяем два этапа: `build` и `test`. Все задачи в этих этапах будут выполняться в соответствующем порядке.

### Настройка Runner'ов

Для исполнения ваших CI/CD задач в GitLab нужны Runners. Их установка настраивается отдельно, и это можно делать вручную или через Docker. Вот как настроить Runner в Docker:

```bash
docker run -d --name gitlab-runner --restart always \
  -v /srv/gitlab-runner/config:/etc/gitlab-runner \
  -v /var/run/docker.sock:/var/run/docker.sock \
  gitlab/gitlab-runner:latest
```

Это создаст новый контейнер с GitLab Runner. Теперь давайте его зарегистрируем:

```bash
docker exec -it gitlab-runner gitlab-runner register
```

Следуйте инструкциям в терминале, чтобы завершить регистрацию.

## Заключение

Поздравляю, теперь вы прошли весь путь от установки Docker до развертывания и настройки GitLab, включающей создание CI/CD процессов. Вы научились запускать GitLab в Docker и подключать Runners для исполнительной среды. Это был увлекательный и полезный процесс, не так ли? Использование Docker и GitLab вместе упрощает процесс управления версиями, разработку и развертывание вашего программного обеспечения. Надеюсь, вам было интересно и, если у вас остались вопросы, не стесняйтесь их задавать. Удачи в ваших проектах!