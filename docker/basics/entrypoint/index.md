---
metaTitle: Использование ENTRYPOINT в Dockerfile
metaDescription: Узнайте как использовать ENTRYPOINT в Dockerfile для создания более гибких и настраиваемых Docker-контейнеров - освоите базовый и продвинутый синтаксис
author: Олег Марков
title: Использование ENTRYPOINT в Dockerfile
preview: Изучите основы и тонкости использования команды ENTRYPOINT в Dockerfile - от базовых принципов до сложных сценариев применения
---

## Введение

Если вы когда-либо работали с Docker, то, вероятно, сталкивались с понятием Dockerfile. Он служит своеобразным рецептом для создания Docker-образов, определяя, какие шаги необходимо выполнить для сборки контейнера. Одной из ключевых возможностей Dockerfile является использование директивы `ENTRYPOINT`. Сегодня мы подробно разберем, как и когда вам стоит применять ENTRYPOINT и чем она отличается от других похожих инструкций, таких как `CMD`.

Давайте разберемся, почему `ENTRYPOINT` так важен и как его использование может улучшить ваши контейнеры.

## Что такое ENTRYPOINT?

`ENTRYPOINT` — это директива в Dockerfile, которая позволяет задать неизменяемую команду, которая всегда будет выполняться при запуске контейнера. Это означает, что при использовании `ENTRYPOINT` у вас появляется точная уверенность, что заданный скрипт или команда всегда будет исполнена, что может быть критично для стабильности и функциональности вашего приложения.

Понимание разницы между `ENTRYPOINT` и `CMD` необходимо для создания гибких и настраиваемых Docker-образов. Правильное использование этих инструкций позволяет определить поведение контейнера при запуске. Если вы хотите детальнее изучить `ENTRYPOINT` и `CMD`, а также другие аспекты создания Docker-образов, приходите на наш большой курс [Docker + Ansible - с нуля](https://purpleschool.ru/course/docker?utm_source=knowledgebase&utm_medium=text&utm_campaign=Ispolzovanie_ENTRYPOINT_v_Dockerfile). На курсе 159 уроков и 7 упражнений, AI-тренажеры для безлимитной практики с кодом и задачами 24/7, решение задач с живым ревью наставника, еженедельные встречи с менторами.

**Пример:**

```dockerfile
FROM ubuntu:latest

# Указываем ENTRYPOINT, которая будет выполнять на запуске контейнера скрипт hello.sh
ENTRYPOINT ["./hello.sh"]
```

В этом примере при запуске контейнера будет всегда выполняться скрипт `hello.sh`. Это может быть полезно, если вы хотите, чтобы ваше приложение всегда запускалось определенным образом.

## Сравнение ENTRYPOINT и CMD

Чтобы полностью оценить возможности `ENTRYPOINT`, важно также понять отличия между `ENTRYPOINT` и `CMD`. Они оба задают команды для выполнения, но работают несколько иначе.

### CMD

`CMD` задает команду по умолчанию, которую можно переопределить при запуске контейнера. 

**Пример CMD:**

```dockerfile
FROM ubuntu:latest

# Указываем CMD, которая может быть заменена на команду, заданную в строке запуска контейнера
CMD ["echo", "Hello, World!"]
```

### ENTRYPOINT и CMD в комбинации

Вы можете использовать `ENTRYPOINT` и `CMD` вместе. `CMD` тогда станет параметром для команды, заданной в `ENTRYPOINT`.

**Пример:**

```dockerfile
FROM ubuntu:latest

# Задаем две директивы ENTRYPOINT и CMD
ENTRYPOINT ["echo"]
CMD ["Hello, World!"]
```

Теперь, при запуске контейнера, будет выполняться команда `echo Hello, World!` потому что `ENTRYPOINT` выводит текст, указанный в `CMD`.

## Практическое использование ENTRYPOINT

### Позиционный и exec форматы

`ENTRYPOINT` может использоваться в двух формах: **позиционной** и **exec**. Лучше всегда предпочитать `exec`-формат, так как он в отличие от позиционного не интерпретируется оболочкой и не требует от нее дополнительных процессорных ресурсов.

**Exec-формат (предпочтительный):**

```dockerfile
ENTRYPOINT ["executable", "param1", "param2"]
```

**Позиционный формат:**

```dockerfile
ENTRYPOINT command param1 param2
```

### Переопределение параметров

С `ENTRYPOINT`, можно инкапсулировать логику. Однако параметры могут быть переданы в момент запуска контейнера, давая определенную гибкость.

**Пример использования параметров:**

```bash
docker run myimage param1 param2
```

Где `param1` и `param2` будут переданы как аргументы в `ENTRYPOINT`.

### Использование скриптов в ENTRYPOINT

Вы можете создать скрипт, который будет принимать параметры и выполнять более сложные задачи.

**Пример с использованием скрипта:**

```dockerfile
FROM ubuntu:latest

COPY entrypoint.sh /usr/local/bin/

# Задаем скрипт в качестве ENTRYPOINT
ENTRYPOINT ["/usr/local/bin/entrypoint.sh"]
```

И сам скрипт:

```bash
#!/bin/bash
# entrypoint.sh

echo "Starting with arguments: $@"
/usr/bin/some-command "$@"
```

## Заключение

Директива `ENTRYPOINT` в Dockerfile позволяет создавать более устойчивые и предсказуемые контейнеры, задавая несменяемую команду для запуска. Это полезно в ситуациях, когда вы хотите быть уверены, что определенный процесс обязательно стартует при запуске контейнера. В то же время, `CMD` предлагает гибкость, позволяя задавать любые команды, которые не попадут внутрь определённого `ENTRYPOINT`. Освоение этих возможностей позволит вам лучше управлять поведением ваших Docker-контейнеров и сделает вашу работу более эффективно. Теперь вы готовы использовать все преимущества `ENTRYPOINT` для создания мощных контейнеров.

Знание разницы между `ENTRYPOINT` и `CMD` важно для создания образов, но для автоматизации этого процесса необходимо использовать инструменты автоматизации. На нашем курсе [Docker + Ansible - с нуля](https://purpleschool.ru/course/docker?utm_source=knowledgebase&utm_medium=text&utm_campaign=Ispolzovanie_ENTRYPOINT_v_Dockerfile) вы научитесь автоматизировать создание Docker-образов с помощью Ansible, включая настройку `ENTRYPOINT` и `CMD`. В первых 3 модулях уже доступно бесплатное содержание — начните погружаться в мир Docker прямо сегодня и станьте экспертом.
