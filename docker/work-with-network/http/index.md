---
metaTitle: Подключение Docker через HTTPS
metaDescription: Узнайте как настроить Docker для использования HTTPS сокета обеспечивая безопасное взаимодействие и повысив уровень защиты вашей системы
author: Олег Марков
title: Подключение Docker через HTTPS
preview: В статье вы научитесь подключать Docker через HTTPS - это обеспечит безопасное соединение и повысит защиту вашей системы от угроз
---

## Введение

Сегодня, безопасность — это один из ключевых аспектов работы с любыми технологиями, в том числе и с контейнеризацией. Docker позволяет изолировать приложения в контейнерах, обеспечивая их безопасную и независимую работу, а подключение Docker через HTTPS предоставляет дополнительный уровень защиты при взаимодействии. HTTPS обеспечивает шифрование данных в сети, что делает ваши соединения безопаснее от различных угроз. В этой статье вы узнаете, как настроить подключение Docker через HTTPS и обеспечить безопасность своих систем.

## Преимущества использования HTTPS с Docker

Перед тем как погрузиться в процесс настройки, давайте сначала обсудим, зачем вам может понадобиться HTTPS в связке с Docker. Вот несколько ключевых преимуществ:

- **Шифрование данных:** HTTPS обеспечивает шифрование данных, передаваемых между вашим клиентом и Docker сервером. Это делает информацию менее уязвимой к перехвату злоумышленниками.
  
- **Аутентификация:** Используя сертификаты, вы можете удостоверяться, что общаетесь с нужным сервером, а также что ваш клиент является доверенным.
  
- **Целостность данных:** HTTPS помогает защитить данные от модификаций в процессе передачи.

Подключение через HTTPS обеспечивает безопасность, но для эффективного управления необходимо понимать, как работают SSL/TLS сертификаты, как настраивать обратный прокси и автоматизировать этот процесс. Если вы хотите детальнее погрузиться в мир Docker и Ansible — приходите на наш большой курс [Docker + Ansible - с нуля](https://purpleschool.ru/course/docker?utm_source=knowledgebase&utm_medium=text&utm_campaign=Podklyuchenie_Docker_cherez_HTTPS). На курсе 159 уроков и 7 упражнений, AI-тренажеры для безлимитной практики с кодом и задачами 24/7, решение задач с живым ревью наставника, еженедельные встречи с менторами.

Раз вы уже понимаете, зачем это нужно, давайте посмотрим, как реализовать эту защиту.

## Настройка Docker для работы через HTTPS

### Шаг 1: Подготовка сертификатов

Первый шаг — это генерация сертификатов, необходимых для обеспечения соединения по HTTPS. Для этого вы можете использовать утилиту OpenSSL. Давайте приступим.

```bash
# Создаем ключи
openssl genrsa -out ca-key.pem 2048

# Генерируем сертификат центра сертификации
openssl req -x509 -new -nodes -key ca-key.pem -days 10000 -out ca.pem -subj "/CN=my-ca"

# Генерируем серверный ключ и запрос на сертификат
openssl genrsa -out server-key.pem 2048
openssl req -new -key server-key.pem -out server.csr -subj "/CN=docker-server"

# Подписываем серверный сертификат
openssl x509 -req -in server.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out server-cert.pem -days 10000
```

Вот что происходит в этом коде:
- Мы сначала создаем закрытый ключ для нашего центра сертификации (Certificate Authority).
- Далее, создаем самоподписанный сертификат для этого ЦС, чтобы использовать его для подписания других сертификатов.
- После этого, создаем закрытый ключ для сервера и запрос на создание сертификата (CSR).
- И, наконец, подписываем серверный сертификат с помощью нашего ЦС.

### Шаг 2: Настройка Docker для использования сертификатов

Теперь, когда у нас есть необходимые сертификаты, нужно убедиться, что Docker использует их. Для этого нам нужно изменить конфигурацию Docker.

Перейдите в файл конфигурации Docker на вашем сервере. Обычно он находится по адресу `/etc/docker/daemon.json`. Если файла не существует, создайте его.

Добавьте следующие строки в файл:

```json
{
  "tls": true,
  "tlsverify": true,
  "tlscacert": "/path/to/ca.pem",
  "tlscert": "/path/to/server-cert.pem",
  "tlskey": "/path/to/server-key.pem",
  "hosts": ["tcp://0.0.0.0:2376"]
}
```

Этот фрагмент кода указывает Docker использовать TLS для соединений, а также путь к нашим сертификатам. Обратите внимание, что нужно указать правильный путь к вашим сертификатам.

### Шаг 3: Перезапуск Docker

Теперь, когда конфигурация изменена, перезапустите Docker, чтобы изменения вступили в силу:

```bash
sudo systemctl restart docker
```

### Шаг 4: Подключение к Docker через HTTPS

Теперь нам нужно настроить Docker клиент для работы с нашим сервером через HTTPS. Убедитесь, что у вас есть копии ваших сертификатов на клиенте.

По умолчанию вы можете подключиться к серверу, используя команду с параметрами для TLS:

```bash
docker --tlsverify --tlscacert=ca.pem --tlscert=server-cert.pem --tlskey=server-key.pem -H=tcp://<YOUR_SERVER_IP>:2376 info
```

Здесь ключи `--tlsverify`, `--tlscacert`, `--tlscert`, `--tlskey` указывают клиенту использовать безопасное подключение с TLS.

## Заключение

Подключение Docker через HTTPS — это важный шаг на пути к обеспечению безопасности ваших развертываний. Этот процесс может показаться сложным на первый взгляд, но следуя четким инструкциям и поняв, для чего каждый шаг предназначен, вы сможете реализовать это быстро и эффективно. Настройка HTTPS для вашего Docker окружения защитит ваши данные и предотвратит попытки несанкционированного доступа.

Использование HTTPS повышает безопасность, но для автоматизации развертывания и масштабирования инфраструктуры необходим Ansible. На нашем курсе [Docker + Ansible - с нуля](https://purpleschool.ru/course/docker?utm_source=knowledgebase&utm_medium=text&utm_campaign=Podklyuchenie_Docker_cherez_HTTPS) вы научитесь интегрировать Docker с Ansible, создавать Docker Swarm кластеры и автоматизировать настройку HTTPS. В первых 3 модулях уже доступно бесплатное содержание — начните погружаться в мир Docker и Ansible прямо сегодня.
