```
---
metaTitle: Подключение Docker через HTTPS
metaDescription: Узнайте как настроить подключение к Docker через HTTPS чтобы обеспечить безопасную передачу данных- Пошаговое руководство с примерами кода и объяснениями
author: Олег Марков
title: Подключение Docker через HTTPS
preview: В этой статье вы узнаете как безопасно подключиться к Docker через HTTPS-создав защищенное соединение для управления контейнерами и сервисами
---

## Введение

Подключение к Docker через HTTPS — это важный шаг для обеспечения безопасности при управлении вашими контейнерами и сервисами. Безопасность данных и их защита от несанкционированного доступа играют критическую роль в современном мире технологий. В этой статье я объясню, как можно настроить такое подключение и какие шаги необходимо предпринять, чтобы ваши данные были в безопасности. Мы продемонстрируем процесс через примеры кода и предложим объяснения, которые помогут вам понять, что происходит на каждом этапе.

### Почему HTTPS?

HTTP по умолчанию не шифрует данные. Это означает, что информация может быть перехвачена злоумышленниками. Использование HTTPS решает эту проблему путем шифрования передаваемого трафика. Это добавляет дополнительный уровень безопасности при доступе к Docker daemon из удалённых мест.

## Настройка подключения Docker через HTTPS

Теперь давайте погрузимся в процесс настройки Docker для работы через HTTPS. Разделим этот процесс на несколько шагов для более ясного понимания.

### Генерация сертификата

Первый шаг — это создание SSL-сертификатов, которые будут использоваться для шифрования данных. Вы можете создать самоподписанные сертификаты с помощью OpenSSL. Вот пример:

```bash
# Создаем ключ для Certificate Authority (CA)
openssl genrsa -out ca-key.pem 2048

# Создаем самоподписанный сертификат CA
openssl req -new -x509 -days 365 -key ca-key.pem -sha256 -out ca.pem
```

В этом примере мы сначала создаём ключ для нашего Центра сертификации (CA), а затем генерируем самоподписанный сертификат на 365 дней.

### Создание сертификатов для сервера

Теперь, когда у нас есть CA, следующий шаг — создать сертификаты для вашего Docker сервера.

```bash
# Создаем ключ и запрос сертификата для сервера
openssl genrsa -out server-key.pem 2048
openssl req -subj "/CN=server" -new -key server-key.pem -out server.csr

# Подписываем запрос сертификата от CA
openssl x509 -req -days 365 -sha256 -in server.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out server-cert.pem
```

Что здесь происходит? Мы создаём серверный ключ и запрос на сертификат, который затем подписывается нашим CA.

### Конфигурация Docker

Теперь, когда сертификаты созданы, пришло время настроить Docker для их использования. Вам нужно будет изменить Docker daemon, чтобы он использовал эти сертификаты.

#### Изменение конфигурации Docker

Возможно, ваш Docker демон может принимать изменения конфигурации через файл `daemon.json`. Здесь пример того, как это сделать:

```json
// Добавляем HTTPS конфигурацию
{
  "tls": true,
  "tlscacert": "/path/to/ca.pem",
  "tlscert": "/path/to/server-cert.pem",
  "tlskey": "/path/to/server-key.pem",
  "hosts": ["tcp://0.0.0.0:2376"]
}
```

Обратите внимание, что указаны пути к нашим файлам сертификатов. Этот файл нужно поместить в конфигурационную директорию Docker, которая обычно находится в `/etc/docker/`.

### Перезапуск Docker

После внесения изменений в конфигурацию, перезагрузите Docker, чтобы они вступили в силу.

```bash
# Перезагрузите Docker демон
sudo systemctl restart docker
```

Если у вас всё настроено правильно, Docker теперь должен слушать подключения через HTTPS на порту 2376.

## Подключение к Docker через клиент

Теперь, когда сервер настроен на использование HTTPS, давайте подключим клиента.

### Настройка клиента

Чтобы клиентское приложение Docker могло подключиться, у него должны быть правильные сертификаты. Сначала скопируйте сертификаты CA и клиентские сертификаты (если они у вас уже есть).

```bash
# Установка клиентских сертификатов
export DOCKER_TLS_VERIFY="1"
export DOCKER_HOST="tcp://<выбор вашего хоста>:2376"
export DOCKER_CERT_PATH="/path/to/client-certs"
```

Здесь мы передаём переменные окружения, которые указывают Docker клиенту использовать TLS для защиты трафика.

## Заключение

Теперь вы увидели, как можно подключить Docker через HTTPS, гарантируя безопасность передаваемых данных. Внедрение такой конфигурации поможет защитить вашу инфраструктуру от несанкционированного доступа и обеспечит безопасное администрирование контейнеров. Надеюсь, этот пошаговый гид помог вам понять процесс настройки и даже, возможно, внедрить его у себя. Спасибо за внимание!