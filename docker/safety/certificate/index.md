---
metaTitle: Сертификаты безопасности в Docker
metaDescription: Узнайте, как использовать сертификаты безопасности в Docker для защитного подключения и передачи данных. Исследуйте процесс создания и управления сертификатами
author: Алексей Петров
title: Сертификаты безопасности в Docker
preview: Поймите, как сертификаты безопасности в Docker обеспечивают защитную связь и передачу данных - от генерации до использования. Изучите суть и методы управления сертификацией
---

## Введение

В мире, где контейнеризация становится все более популярной, важно учитывать аспекты безопасности. Docker, как одна из самых распространенных и мощных технологий контейнеризации, предоставляет инструменты для обеспечения безопасности соединений и передачи данных. Сертификаты безопасности — это один из таких инструментов, который позволяет гарантировать зашифрованное соединение и защищает данные от несанкционированного доступа. В этой статье мы рассмотрим, как сертификаты безопасности используются в Docker, и узнаем, как их настроить и управлять ими для обеспечения безопасной работы вашей инфраструктуры контейнеров.

## Что такое сертификаты безопасности в Docker

Сертификаты безопасности в Docker используются для проверки подлинности и обеспечения конфиденциальности соединений между различными компонентами Docker, такими как сервер Docker, Docker CLI и другие сервисы. Они основаны на популярном протоколе TLS (Transport Layer Security), который предоставляет шифрование передаваемых данных.

Использование сертификатов безопасности позволяет обеспечить защищенное подключение и передачу данных в Docker-контейнерах. Чтобы правильно создавать и управлять сертификатами, необходимо понимать принципы работы SSL/TLS и Docker. Если вы хотите детальнее погрузиться в Docker, узнать про настройку VM на Linux, базовые понятия Docker, Docker image, сети Docker — приходите на наш большой курс [Docker + Ansible - с нуля](https://purpleschool.ru/course/docker). На курсе 159 уроков и 7 упражнений, AI-тренажеры для безлимитной практики с кодом и задачами 24/7, решение задач с живым ревью наставника, еженедельные встречи с менторами.

### Принципы работы TLS в Docker

TLS (Transport Layer Security) предоставляет возможность безопасного обмена данными между клиентом и сервером. Сертификаты выступают в роли доверенного посредника, который подтверждает подлинность узлов Docker, инициирующих соединения. Благодаря этому механизму можно защитить коммуникацию и предотвратить атаки типа "Man in the Middle".

## Настройка и использование сертификатов

Теперь давайте посмотрим, как можно настроить и использовать сертификаты безопасности в Docker для обеспечения защищенных соединений.

### Генерация сертификатов

Первым шагом в настройке безопасного соединения является генерация сертификатов. Вы можете создать самоподписанные сертификаты или использовать их от доверенного центра сертификации. Рассмотрим, как создать самоподписанные сертификаты:

1. Установите `OpenSSL` — это инструмент с открытым исходным кодом, который используется для создания и управления сертификатами безопасности.

2. Сгенерируйте приватный ключ для вашего сервера:
   ```bash
   openssl genrsa -out ca-key.pem 4096
   ```
   // Генерируем приватный ключ для центра сертификации (CA).

3. Создайте сертификат центра сертификации (CA):
   ```bash
   openssl req -new -x509 -days 365 -key ca-key.pem -sha256 -out ca.pem
   ```
   // Создаем самоподписанный сертификат на основе приватного ключа.

4. После этого сгенерируйте приватный ключ и запрос на сертификат для сервера:
   ```bash
   openssl genrsa -out server-key.pem 4096
   ```
   // Генерируем приватный ключ для сервера Docker.
   ```bash
   openssl req -subj "/CN=server" -new -key server-key.pem -out server.csr
   ```
   // Запрос на сертификат для сервера (CSR).

5. Подпишите запрос на сертификат, используя CA:
   ```bash
   openssl x509 -req -days 365 -sha256 -in server.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out server-cert.pem
   ```
   // Подписываем сертификат сервера с использованием CA.

6. Создайте и подпишите клиентский сертификат аналогично:

   ```bash
   openssl genrsa -out key.pem 4096
   ```
   // Генерация приватного ключа для клиента.

   ```bash
   openssl req -subj "/CN=client" -new -key key.pem -out client.csr
   ```
   // Создание запроса на сертификат для клиента.

   ```bash
   openssl x509 -req -days 365 -sha256 -in client.csr -CA ca.pem -CAkey ca-key.pem -CAcreateserial -out cert.pem
   ```
   // Подпись клиентского сертификата с использованием CA.

### Настройка Docker на использование сертификатов

Теперь, когда у вас есть необходимые сертификаты, Docker должен быть настроен на их использование.

#### Конфигурация Docker сервера

Создайте и отредактируйте файл конфигурации Docker Daemon, чтобы указать, где находятся сертификаты:

```bash
{
  "tls": true,
  "tlscacert": "/path/to/ca.pem",
  "tlscert": "/path/to/server-cert.pem",
  "tlskey": "/path/to/server-key.pem"
}
```
Добавьте этот JSON-код в файл `/etc/docker/daemon.json` на машине, где работает Docker сервер.

Перезагрузите Docker службу, чтобы изменения вступили в силу:

```bash
sudo systemctl restart docker
```
#### Конфигурация Docker клиента

Для клиента Docker CLI необходимо указать пути к сертификатам при выполнении команд:

```bash
docker --tlsverify \
  --tlscacert=/path/to/ca.pem \
  --tlscert=/path/to/cert.pem \
  --tlskey=/path/to/key.pem \
  -H=hostname:2376 info
```
// Здесь мы указываем клиенту использовать TLS сертификаты для проверенного подключения.

## Заключение

Сертификаты безопасности играют ключевую роль в защите соединений и данных при работе с Docker. Настройка и использование TLS сертификатов позволяет предотвратить несанкционированный доступ и защитить чувствительную информацию в ваших контейнерах. Несмотря на то, что процесс генерации и настройки сертификатов может показаться сложным для новичков, он обеспечивает высокий уровень безопасности и доверия между компонентами Docker. Надеемся, что эта статья помогла вам понять основные шаги в настройке безопасных соединений в Docker.

Для автоматизации создания и управления сертификатами безопасности в Docker можно использовать Ansible. На нашем курсе [Docker + Ansible - с нуля](https://purpleschool.ru/course/docker) вы научитесь автоматизировать эти задачи. В первых 3 модулях уже доступно бесплатное содержание — начните погружаться в Docker и Ansible прямо сегодня.
