---
metaTitle: Основы и применение директив в Vue
metaDescription: Подробное руководство по основам и практике работы с директивами в Vue - разбор синтаксиса, особенностей применения, создания пользовательских директив и частые вопросы
author: Олег Марков
title: Основы и применение директив в Vue
preview: Погрузитесь в работу с директивами в Vue - от базовых встроенных до написания собственных и тонкостей их жизненного цикла
---

## Введение

Директивы — это одна из самых заметных особенностей фреймворка Vue. С их помощью вы можете динамически управлять поведением, стилями или структурой ваших компонентов прямо из шаблона. Директивы позволяют расширять базовый HTML, добавляя интерактивность и гибкость без необходимости напрямую вмешиваться в JavaScript-логику. Если вы только начинаете работать с Vue или хотите лучше понять, как эффективно использовать директивы в своих проектах, эта статья поможет разобраться во всех ключевых моментах использования, написания и настройки директив.

## Что такое директивы в Vue

В Vue директива — это специальный атрибут (обычно с префиксом `v-`), который вы добавляете к HTML-элементу для связывания с определённым поведением данного элемента. Когда Vue компилирует шаблон, он обрабатывает эти директивы, чтобы добавить логику работы с DOM.

Например, директива `v-if` решает, показывать или скрывать элемент, а `v-model` обеспечивает двустороннюю связь данных с полями формы.

Использование директив значительно расширяет возможности Vue, но для создания сложных и поддерживаемых приложений важно понимать, как правильно организовать компоненты, управлять состоянием и настроить взаимодействие между ними. Если вы хотите получить всесторонние знания и навыки в разработке Vue-приложений, приходите на наш большой курс [Vue.js 3, Vue Router и Pinia](https://purpleschool.ru/course/vuejs?utm_source=knowledgebase&utm_medium=article&utm_campaign=ispolzovanie-direktiv-v-vue-i-ih-rasshirennye-vozmozhnosti). На курсе 173 уроков и 21 упражнение, AI-тренажеры для безлимитной практики с кодом и задачами 24/7, решение задач с живым ревью наставника, еженедельные встречи с менторами.

### Почему это важно

Директивы позволяют отделить логику представления от бизнес-логики, делая ваш шаблон мощнее и выразительнее. Это снижает объем кода и повышает его читаемость.

## Встроенные директивы Vue

Vue имеет набор встроенных директив, которые покрывают практически все основные задачи управления DOM. Давайте рассмотрим самые часто используемые:

### v-bind

Директива `v-bind` привязывает атрибут HTML к выражению на вашем экземпляре Vue.

```html
<!-- Пример: делаем динамический src у картинки -->
<img v-bind:src="imageSrc" alt="Картинка">
```

```js
// В data у компонента
data() {
  return {
    imageSrc: 'https://picsum.photos/200'
  }
}
```

`v-bind:src` можно коротко записать как `:src`. Также такое связывание работает с любым атрибутом, не только с `src`.

### v-model

Директива `v-model` используется для двусторонней привязки между данными и элементом формы.

```html
<input v-model="email" placeholder="Введите почту">
// Теперь email в data будет обновляться вместе с вводом пользователя
```

```js
data() {
  return {
    email: ''
  }
}
```

Это невероятно удобно для создания форм, где изменения от пользователя должны мгновенно отображаться в состоянии компонента.

### v-if, v-else-if и v-else

С помощью этих директив вы управляете видимостью элементов на основе условий.

```html
<p v-if="user">Добро пожаловать, {{ user.name }}!</p>
<p v-else>Пожалуйста, авторизуйтесь</p>
```

Когда `user` определён, показывается приветствие. Если `user` равен `null`, показывается другой текст.

### v-show

Если вам нужно часто скрывать и показывать элементы, вместо `v-if` используйте `v-show`. Отличие: `v-if` добавляет или убирает элемент из DOM, а `v-show` просто переключает свойство `display` через CSS.

```html
<div v-show="isVisible">Этот блок спрятан, но всё равно остаётся в DOM</div>
```

### v-for

Для вывода списков часто применяется `v-for`.

```html
<ul>
  <li v-for="item in items" :key="item.id">
    {{ item.text }}
  </li>
</ul>
```

```js
data() {
  return {
    items: [
      { id: 1, text: 'Пункт 1' },
      { id: 2, text: 'Пункт 2' },
    ]
  }
}
```

`v-for` требует обязательное указание ключа через `:key` — это важно для оптимизации внутренней работы Vue.

### v-on

Директива `v-on` привязывает обработчики событий к элементам.

```html
<button v-on:click="doSomething">Кликните меня</button>
```

```js
methods: {
  doSomething() {
    // Ваш код обработки события
  }
}
```

Аналогичная короткая форма — `@click`.

## Модификаторы и аргументы директив

У многих директив есть модификаторы и аргументы, которые позволяют ещё больше контролировать их поведение.

### Модификаторы

Модификаторы — это специальные суффиксы, указываемые после точки.

```html
<input v-model.lazy="message">
// Обновит message только при событии "change", а не "input"
```

```html
<form v-on:submit.prevent="handleSubmit">
// Не отправит форму по умолчанию, только вызовет handleSubmit
```

### Аргументы

Аргументы позволяют передавать дополнительные параметры, например, имя атрибута или название события.

```html
<!-- v-bind с аргументом href -->
<a v-bind:href="url">Ссылка</a>
<!-- или коротко -->
<a :href="url">Ссылка</a>

<!-- v-on с аргументом click -->
<button v-on:click="clickHandler">Нажми меня</button>
<!-- или коротко -->
<button @click="clickHandler">Нажми меня</button>
```

## Жизненный цикл директив

Внутри Vue каждой директиве выделяется определённый жизненный цикл. Если вы создаёте свою директиву, вы сможете использовать специальные хуки жизненного цикла:

- `created` — вызывается один раз при инициализации
- `beforeMount` — до вставки элемента в DOM
- `mounted` — когда элемент добавлен в DOM
- `beforeUpdate` — перед обновлением компонента
- `updated` — после обновления компонента
- `beforeUnmount` — перед удалением
- `unmounted` — после удаления из DOM

Обычно используются хуки `mounted` и `updated`, чтобы подписаться на события или взаимодействовать с DOM.

## Создание пользовательских директив

Иногда стандартных директив недостаточно — тогда пригодятся пользовательские директивы. Вы можете зарегистрировать директиву глобально или локально.

### Глобальная регистрация

```js
// Регистрируем глобально
app.directive('focus', {
  mounted(el) {
    el.focus();
  }
});
```

В шаблоне используете так:

```html
<input v-focus>
```

Когда этот инпут появится, он сразу получит фокус. Попробуйте в своём проекте — вы заметите, как просто это работает.

### Локальная регистрация

Если не надо использовать директиву по всему приложению, удобно регистрировать её только в конкретном компоненте.

```js
export default {
  directives: {
    focus: {
      mounted(el) {
        el.focus();
      }
    }
  }
}
```

Теперь внутри этого компонента директива доступна так же, как глобальная.

### Подробный пример директивы

Реализуем директиву, которая меняет цвет текста элемента на указанный.

```js
// Регистрируем директиву v-color глобально
app.directive('color', {
  mounted(el, binding) {
    // binding.value содержит значение, переданное в директиву
    el.style.color = binding.value;
  },
  updated(el, binding) {
    // При обновлении значения мы также меняем цвет
    el.style.color = binding.value;
  }
});
```

В шаблоне используйте вот так:

```html
<p v-color="'red'">Этот текст станет красным</p>
<p v-color="textColor">А этот — цветом из data</p>
```

### Аргументы и модификаторы в пользовательских директивах

Можно добавить поддержку аргументов и модификаторов, чтобы ваша директива стала гибче.

```js
// Директива для задания цвета и фона
app.directive('colorful', {
  mounted(el, binding) {
    // binding.arg — аргумент директивы (например, "background")
    // binding.modifiers — наличие модификаторов, например .bold
    if (binding.arg === 'background') {
      el.style.backgroundColor = binding.value;
    } else {
      el.style.color = binding.value;
    }

    if (binding.modifiers.bold) {
      el.style.fontWeight = 'bold';
    }
  }
});
```

```html
<span v-colorful.bold="'green'">Зеленый и жирный</span>
<span v-colorful:background="'yellow'">Желтый фон</span>
```

## Практические примеры использования директив

Для чего реально нужны пользовательские директивы? Вот несколько классических сценариев:

- Автоматическая фокусировка в поля ввода при открытии формы (v-focus)
- Слежение за кликом вне определенного блока для закрытия выпадающего меню (v-click-outside)
- Эффекты или анимации при наведении мыши (v-hover)
- Маски для полей ввода
- Drag & Drop функциональность

### Пример: v-click-outside

Давайте реализуем простую директиву, которая подслушивает клики вне элемента.

```js
app.directive('click-outside', {
  mounted(el, binding) {
    // Создаем обработчик
    el.__vueClickOutside__ = event => {
      // Если клик был вне элемента — вызываем функцию
      if (!(el === event.target || el.contains(event.target))) {
        binding.value(event);
      }
    }
    document.body.addEventListener('click', el.__vueClickOutside__);
  },
  unmounted(el) {
    document.body.removeEventListener('click', el.__vueClickOutside__);
    el.__vueClickOutside__ = null;
  }
});
```

В шаблоне:

```html
<div v-click-outside="closeMenu">Меню...</div>
```

```js
methods: {
  closeMenu() {
    // Здесь код для скрытия меню
  }
}
```

Как видите, теперь обработчик сработает, если клик был за пределами блока — это очень удобно для закрытия модальных окон, тултипов, dropdown-меню.

## Ограничения и рекомендации при работе с директивами

- Не используйте директивы там, где проще обойтись computed-свойствами или методами.
- Внутри пользовательских директив избегайте сложной бизнес-логики — они должны решать только задачи, связанные с работой DOM.
- Следите за утечкой обработчиков событий — всегда корректно очищайте их в хуке `unmounted`.
- Старайтесь делать свои директивы универсальными — принимайте аргументы и модификаторы для максимальной гибкости.

## Тонкости работы директив в Vue 3

В Vue 3 структура директив почти не изменилась по сравнению с Vue 2, но секция хуков теперь используется под новыми названиями и рекомендуется использовать функцию вместо объекта, если нужен только один хук (обычно `mounted`). Также теперь регистрация директив идет через экземпляр приложения (`app.directive` вместо глобального Vue в Vue 2).

Вот пример краткой директивы только с функцией:

```js
app.directive('autofocus', el => el.focus());
```

Если нужны жизненные циклы, используйте объект с нужными хуками:

```js
app.directive('custom', {
  mounted(el, binding, vnode, prevVnode) {
    // Ваша логика
  },
  updated(el, binding, vnode, prevVnode) {
    // Ваша логика
  }
});
```

## Заключение

Директивы делают шаблоны Vue лаконичнее, а управление DOM — более мощным и декларативным. Разобравшись с их синтаксисом, аргументами, модификаторами и жизненным циклом, вы получите простой и расширяемый способ добавлять интерактивность и реактивность в свои компоненты. Создание собственных директив позволит покрыть особые сценарии, с которыми стандартные средства не справляются так элегантно. Используйте директивы осознанно, не забывая об их ограничениях и лучшем применении.

Расширенные возможности директив - это мощный инструмент, но он требует глубокого понимания архитектуры приложения. Чтобы создавать по-настоящему профессиональные решения, нужно уверенно владеть маршрутизацией, управлением состоянием и другими важными аспектами. На нашем курсе [Vue.js 3, Vue Router и Pinia](https://purpleschool.ru/course/vuejs?utm_source=knowledgebase&utm_medium=article&utm_campaign=ispolzovanie-direktiv-v-vue-i-ih-rasshirennye-vozmozhnosti) вы получите все необходимые знания и навыки. В первых 3 модулях уже доступно бесплатное содержание — начните погружаться в мир Vue прямо сегодня.

## Частозадаваемые технические вопросы по теме статьи и ответы на них

### Как получить доступ к аргументам и модификаторам внутри своей директивы?

Внутри пользовательской директивы в параметре `binding` доступны:
- `binding.value` — основное значение;
- `binding.arg` — аргумент директивы (например, цвет или имя атрибута);
- `binding.modifiers` — объект с булевыми значениями для каждого модификатора.
Например:
```js
mounted(el, binding) {
  console.log(binding.value); // ваше значение
  console.log(binding.arg); // аргумент
  console.log(binding.modifiers); // { bold: true, italic: false }
}
```

### Как корректно снять обработчики событий внутри директивы?

Сохраняйте свой обработчик на элементе (например, `el.__myHandler__ = fn`) и в хуке `unmounted` удаляйте его:
```js
mounted(el) {
  el.__myHandler__ = event => { /* ... */ };
  document.addEventListener('click', el.__myHandler__);
},
unmounted(el) {
  document.removeEventListener('click', el.__myHandler__);
}
```

### Как передать несколько параметров в пользовательскую директиву?

Передавайте объект как значение:
```html
<div v-my-directive="{ color: 'red', size: 12 }"></div>
```
В директиве:
```js
mounted(el, binding) {
  const { color, size } = binding.value;
  // дальше используете color и size
}
```

### Как использовать директиву только в одном компоненте (локально)?

Добавьте директиву в объект `directives` компонента:
```js
export default {
  directives: {
    myDirective: { mounted(el) { /* ... */ } }
  }
}
```
Теперь директива доступна только в этом компоненте.

### Можно ли в директивах корректировать содержимое слота?

Директивы применяются к рендеренному элементу и не могут вмешиваться в логику или содержимое слотов на этапе компиляции. Для управления содержимым слотов используйте computed-свойства или шаблонную логику родительского компонента.
